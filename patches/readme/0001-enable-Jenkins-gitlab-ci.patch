From feedad28033bdd448a21794d49884416e010055f Mon Sep 17 00:00:00 2001
From: Robert Nelson <robertcnelson@gmail.com>
Date: Wed, 20 Jul 2022 14:24:23 -0500
Subject: [PATCH] enable: Jenkins/gitlab-ci

Signed-off-by: Robert Nelson <robertcnelson@gmail.com>
---
 .github/FUNDING.yml                  | 12 ++++++++++++
 .github/ISSUE_TEMPLATE/bug_report.md | 20 ++++++++++++++++++++
 .gitlab-ci.yml                       | 12 ++++++++++++
 Jenkinsfile                          | 11 +++++++++++
 README.md                            | 15 +++++++++++++++
 jenkins_build.sh                     | 12 ++++++++++++
 6 files changed, 82 insertions(+)
 create mode 100644 .github/FUNDING.yml
 create mode 100644 .github/ISSUE_TEMPLATE/bug_report.md
 create mode 100644 .gitlab-ci.yml
 create mode 100644 Jenkinsfile
 create mode 100644 README.md
 create mode 100755 jenkins_build.sh

diff --git a/.github/FUNDING.yml b/.github/FUNDING.yml
new file mode 100644
index 000000000000..8b20af1e3599
--- /dev/null
+++ b/.github/FUNDING.yml
@@ -0,0 +1,12 @@
+# These are supported funding model platforms
+
+github: beagleboard # Replace with up to 4 GitHub Sponsors-enabled usernames e.g., [user1, user2]
+patreon: beagleboard # Replace with a single Patreon username
+open_collective: # Replace with a single Open Collective username
+ko_fi: # Replace with a single Ko-fi username
+tidelift: # Replace with a single Tidelift platform-name/package-name e.g., npm/babel
+community_bridge: # Replace with a single Community Bridge project-name e.g., cloud-foundry
+liberapay: # Replace with a single Liberapay username
+issuehunt: # Replace with a single IssueHunt username
+otechie: # Replace with a single Otechie username
+custom: https://paypal.me/beagleboard # Replace with up to 4 custom sponsorship URLs e.g., ['link1', 'link2']
diff --git a/.github/ISSUE_TEMPLATE/bug_report.md b/.github/ISSUE_TEMPLATE/bug_report.md
new file mode 100644
index 000000000000..94be17e338b3
--- /dev/null
+++ b/.github/ISSUE_TEMPLATE/bug_report.md
@@ -0,0 +1,20 @@
+---
+name: Bug report
+about: Create a report to help us improve
+title: ''
+labels: ''
+assignees: ''
+
+---
+
+**Describe the bug**
+A clear and concise description of what the bug is.
+
+**Describe how to reproduce the bug**
+List all the steps needed to reproduce the bug
+
+**REQUIRED INFORMATION**
+Run this command and paste the output here:
+```
+sudo /opt/scripts/tools/version.sh
+```
diff --git a/.gitlab-ci.yml b/.gitlab-ci.yml
new file mode 100644
index 000000000000..aff5609e5410
--- /dev/null
+++ b/.gitlab-ci.yml
@@ -0,0 +1,12 @@
+image: debian:bullseye
+
+build:
+  stage: build
+  before_script:
+    - apt update && apt -y install build-essential bc kmod cpio flex libncurses5-dev libelf-dev libssl-dev dwarves bison lsb-release rsync lzop gcc-arm-linux-gnueabihf
+  script:
+    - ./jenkins_build.sh
+    - mv ../*.deb .
+  artifacts:
+    paths:
+      - "*.deb"
diff --git a/Jenkinsfile b/Jenkinsfile
new file mode 100644
index 000000000000..5d5776ff0e8b
--- /dev/null
+++ b/Jenkinsfile
@@ -0,0 +1,11 @@
+pipeline {
+    agent { label 'amd64'}
+
+    stages {
+        stage('Build') {
+            steps {
+                sh '/bin/bash ./jenkins_build.sh'
+            }
+        }
+    }
+}
diff --git a/README.md b/README.md
new file mode 100644
index 000000000000..2909f8c6bb21
--- /dev/null
+++ b/README.md
@@ -0,0 +1,15 @@
+# Gitlab CI
+
+| kernel | normal | rt |
+|:---:|:---:|:---:|
+|4.19 | [![Build Status](https://git.beagleboard.org/beagleboard/linux/badges/4.19/pipeline.svg)](https://git.beagleboard.org/beagleboard/linux/-/pipelines?page=1&scope=all&ref=4.19) | [![Build Status](https://git.beagleboard.org/beagleboard/linux/badges/4.19-rt/pipeline.svg)](https://git.beagleboard.org/beagleboard/linux/-/pipelines?page=1&scope=all&ref=4.19-rt) |
+|5.4 | [![Build Status](https://git.beagleboard.org/beagleboard/linux/badges/5.4/pipeline.svg)](https://git.beagleboard.org/beagleboard/linux/-/pipelines?page=1&scope=all&ref=5.4) | [![Build Status](https://git.beagleboard.org/beagleboard/linux/badges/5.4-rt/pipeline.svg)](https://git.beagleboard.org/beagleboard/linux/-/pipelines?page=1&scope=all&ref=5.4-rt) |
+|5.10 | [![Build Status](https://git.beagleboard.org/beagleboard/linux/badges/5.10/pipeline.svg)](https://git.beagleboard.org/beagleboard/linux/-/pipelines?page=1&scope=all&ref=5.10) | [![Build Status](https://git.beagleboard.org/beagleboard/linux/badges/5.10-rt/pipeline.svg)](https://git.beagleboard.org/beagleboard/linux/-/pipelines?page=1&scope=all&ref=5.10-rt) |
+
+# Jenkins
+
+| kernel | normal | rt |
+|:---:|:---:|:---:|
+|4.19 | [![Build Status](http://eewiki.org:8080/job/ci-beagleboard-linux/job/4.19/badge/icon)](http://eewiki.org:8080/job/ci-beagleboard-linux/job/4.19/) | [![Build Status](http://eewiki.org:8080/job/ci-beagleboard-linux/job/4.19-rt/badge/icon)](http://eewiki.org:8080/job/ci-beagleboard-linux/job/4.19-rt/) |
+|5.4 | [![Build Status](http://eewiki.org:8080/job/ci-beagleboard-linux/job/5.4/badge/icon)](http://eewiki.org:8080/job/ci-beagleboard-linux/job/5.4/) | [![Build Status](http://eewiki.org:8080/job/ci-beagleboard-linux/job/5.4-rt/badge/icon)](http://eewiki.org:8080/job/ci-beagleboard-linux/job/5.4-rt/) |
+|5.10 | [![Build Status](http://eewiki.org:8080/job/ci-beagleboard-linux/job/5.10/badge/icon)](http://eewiki.org:8080/job/ci-beagleboard-linux/job/5.10/) | [![Build Status](http://eewiki.org:8080/job/ci-beagleboard-linux/job/5.10-rt/badge/icon)](http://eewiki.org:8080/job/ci-beagleboard-linux/job/5.10-rt/) |
diff --git a/jenkins_build.sh b/jenkins_build.sh
new file mode 100755
index 000000000000..10471e603d3e
--- /dev/null
+++ b/jenkins_build.sh
@@ -0,0 +1,12 @@
+#!/bin/bash
+
+#git clone -b 5.10 https://github.com/beagleboard/linux --depth=10
+#cd ./linux
+
+export CC=/usr/bin/arm-linux-gnueabihf-
+
+make ARCH=arm CROSS_COMPILE=${CC} clean
+make ARCH=arm CROSS_COMPILE=${CC} bb.org_defconfig
+
+echo "make -j4 ARCH=arm KBUILD_DEBARCH=armhf CROSS_COMPILE=${CC} bindeb-pkg"
+make -j4 ARCH=arm KBUILD_DEBARCH=armhf KDEB_PKGVERSION=1xross CROSS_COMPILE=${CC} bindeb-pkg
-- 
2.30.2

